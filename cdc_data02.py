"""This looks at CDC_data, furnished by Socrata, querying the json directly (no pandas)."""

### some important pieces of information:
# App Token: os.environ['SOCRATA_APP_TOKEN']
# dataset_identifier: '9mfq-cb36'
# sample query:
# https://data.cdc.gov/resource/9mfq-cb36.json?submission_date=2021-02-20T00:00:00.000

import requests
import json
import os
from sodapy import Socrata

socrata_domain = 'data.cdc.gov'
socrata_dataset_identifier = '9mfq-cb36'
socrata_token = os.environ['SOCRATA_APP_TOKEN'] # Token in secrets.sh; turned into a global environmental variable

client = Socrata(socrata_domain, socrata_token)

metadata = client.get_metadata('9mfq-cb36') # this is the metadata, not the data
########### FINDING OUT ABOUT THE METADATA #############
#print(metadata.keys())
    #OUTPUT: dict_keys(['id', 'name', 'assetType', 'attribution', 'attributionLink', 'averageRating', 'category', 'createdAt', 'description', 'displayType', 'downloadCount', 'hideFromCatalog', 'hideFromDataJson', 'licenseId', 'newBackend', 'numberOfComments', 'oid', 'provenance', 'publicationAppendEnabled', 'publicationDate', 'publicationGroup', 'publicationStage', 'rowsUpdatedAt', 'rowsUpdatedBy', 'tableId', 'totalTimesRated', 'viewCount', 'viewLastModified', 'viewType', 'approvals', 'columns', 'grants', 'license', 'metadata', 'owner', 'query', 'rights', 'tableAuthor', 'tags', 'flags'])

#print(metadata['name'])
    #OUTPUT: United States COVID-19 Cases and Deaths by State over Time

#print([x['name'] for x in metadata['columns']], ('***'*20))
    #OUTPUT: ['submission_date', 'state', 'tot_cases', 'conf_cases', 'prob_cases', 'new_case', 'pnew_case', 'tot_death', 'conf_death', 'prob_death', 'new_death', 'pnew_death', 'created_at', 'consent_cases', 'consent_deaths']


#meta_amount = [x for x in metadata['columns'] if x['name'] == 'submission_date'][0]
#print(len(meta_amount), meta_amount)
    #OUTPUT: 10 {'id': 481357041, 'name': 'submission_date', 'dataTypeName': 'calendar_date', 'description': 'Date of counts', 'fieldName': 'submission_date', 'position': 1, 'renderTypeName': 'calendar_date', 'tableColumnId': 105526416, 'cachedContents': {'non_null': '24120', 'largest': '2021-02-26T00:00:00.000', 'null': '0', 'top': [{'item': '2020-03-28T00:00:00.000', 'count': '60'}, {'item': '2020-11-27T00:00:00.000', 'count': '60'}, {'item': '2021-01-07T00:00:00.000', 'count': '60'}, {'item': '2021-01-30T00:00:00.000', 'count': '60'}, {'item': '2020-05-08T00:00:00.000', 'count': '60'}, {'item': '2020-04-11T00:00:00.000', 'count': '60'}, {'item': '2021-01-17T00:00:00.000', 'count': '60'}, {'item': '2020-10-28T00:00:00.000', 'count': '60'}, {'item': '2020-09-04T00:00:00.000', 'count': '60'}, {'item': '2020-03-25T00:00:00.000', 'count': '60'}, {'item': '2020-05-01T00:00:00.000', 'count': '60'}, {'item': '2020-08-14T00:00:00.000', 'count': '60'}, {'item': '2020-03-14T00:00:00.000', 'count': '60'}, {'item': '2020-11-17T00:00:00.000', 'count': '60'}, {'item': '2020-08-02T00:00:00.000', 'count': '60'}, {'item': '2020-07-09T00:00:00.000', 'count': '60'}, {'item': '2020-01-29T00:00:00.000', 'count': '60'}, {'item': '2020-07-10T00:00:00.000', 'count': '60'}, {'item': '2020-12-25T00:00:00.000', 'count': '60'}, {'item': '2020-04-19T00:00:00.000', 'count': '60'}], 'smallest': '2020-01-22T00:00:00.000', 'cardinality': '402'}, 'format': {'view': 'date'}}
    ### What you can see here are the most recent and the earliest dates (largest and smallest), and that there are '24120' non-null values

#### GOAL: get total deaths for 2021-02-20
# Here is the total json response for the query:
# https://data.cdc.gov/resource/9mfq-cb36.json?submission_date=2021-02-20T00:00:00.000
####
####

# these will be variables in Jinja rather than hard-coded: 
phrase_state = 'OH'
phrase_date = '2021-02-20'

#response = requests.get(f'https://data.cdc.gov/resource/9mfq-cb36.json?state={phrase_state}&submission_date={phrase_date}T00:00:00.000')
response = requests.get(f'https://data.cdc.gov/resource/9mfq-cb36.json?&submission_date={phrase_date}T00:00:00.000')
    # print a check: is the query successful, i.e., a 200?
print('***2'*10, response.status_code)
    

response = response.json()
print(len(response)) # response is a list with 60 items in it
                     # it is grouped by locality (states and territories)

national_data = response
day_death_total = 0
for count, state_full_data in enumerate(national_data):
    day_death_total = day_death_total + int(state_full_data['tot_death'])
    print(count, state_full_data['state'], state_full_data['tot_death'])

print('national death total for this day is', day_death_total)

# [
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NYC",
#         "tot_cases": "698851",
#         "conf_cases": "592353.0",
#         "prob_cases": "106498",
#         "new_case": "3355.0",
#         "pnew_case": "803",
#         "tot_death": "28825",
#         "conf_death": "23798.0",
#         "prob_death": "5027",
#         "new_death": "76.0",
#         "pnew_death": "-4",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "AR",
#         "tot_cases": "315230",
#         "new_case": "517.0",
#         "pnew_case": "201",
#         "tot_death": "5348",
#         "new_death": "12.0",
#         "pnew_death": "1",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "SD",
#         "tot_cases": "111165",
#         "new_case": "147.0",
#         "pnew_case": "42",
#         "tot_death": "1859",
#         "conf_death": "1507.0",
#         "prob_death": "352",
#         "new_death": "6.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "N/A",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "GA",
#         "tot_cases": "983747",
#         "conf_cases": "803349.0",
#         "prob_cases": "180398",
#         "new_case": "3336.0",
#         "pnew_case": "946",
#         "tot_death": "16742",
#         "conf_death": "14629.0",
#         "prob_death": "2113",
#         "new_death": "132.0",
#         "pnew_death": "33",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "RMI",
#         "tot_cases": "4",
#         "conf_cases": "4.0",
#         "prob_cases": "0",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "0",
#         "conf_death": "0.0",
#         "prob_death": "0",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "AS",
#         "tot_cases": "4",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "0",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "CO",
#         "tot_cases": "419812",
#         "conf_cases": "397269.0",
#         "prob_cases": "22543",
#         "new_case": "1117.0",
#         "pnew_case": "139",
#         "tot_death": "5887",
#         "conf_death": "5159.0",
#         "prob_death": "728",
#         "new_death": "9.0",
#         "pnew_death": "-2",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "UT",
#         "tot_cases": "366034",
#         "conf_cases": "366034.0",
#         "prob_cases": "0",
#         "new_case": "778.0",
#         "pnew_case": "0",
#         "tot_death": "1842",
#         "conf_death": "1785.0",
#         "prob_death": "57",
#         "new_death": "8.0",
#         "pnew_death": "-1",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MA",
#         "tot_cases": "548224",
#         "conf_cases": "538328.0",
#         "prob_cases": "9896",
#         "new_case": "1822.0",
#         "pnew_case": "0",
#         "tot_death": "15670",
#         "conf_death": "15462.0",
#         "prob_death": "208",
#         "new_death": "53.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "OK",
#         "tot_cases": "421715",
#         "conf_cases": "327488.0",
#         "prob_cases": "94227",
#         "new_case": "1013.0",
#         "pnew_case": "366",
#         "tot_death": "4191",
#         "conf_death": "3699.0",
#         "prob_death": "492",
#         "new_death": "26.0",
#         "pnew_death": "7",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "KY",
#         "tot_cases": "396018",
#         "conf_cases": "304886.0",
#         "prob_cases": "91132",
#         "new_case": "1331.0",
#         "pnew_case": "531",
#         "tot_death": "4426",
#         "conf_death": "4017.0",
#         "prob_death": "409",
#         "new_death": "25.0",
#         "pnew_death": "3",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "IN",
#         "tot_cases": "654660",
#         "new_case": "1415.0",
#         "pnew_case": "0",
#         "tot_death": "12336",
#         "conf_death": "11912.0",
#         "prob_death": "424",
#         "new_death": "11.0",
#         "pnew_death": "-3",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "CA",
#         "tot_cases": "3435186",
#         "new_case": "6668.0",
#         "pnew_case": "0",
#         "tot_death": "48825",
#         "new_death": "481.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "AZ",
#         "tot_cases": "806163",
#         "conf_cases": "751951.0",
#         "prob_cases": "54212",
#         "new_case": "2047.0",
#         "pnew_case": "165",
#         "tot_death": "15480",
#         "conf_death": "13674.0",
#         "prob_death": "1806",
#         "new_death": "59.0",
#         "pnew_death": "13",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MS",
#         "tot_cases": "290632",
#         "conf_cases": "180867.0",
#         "prob_cases": "109765",
#         "new_case": "390.0",
#         "pnew_case": "240",
#         "tot_death": "6553",
#         "conf_death": "4610.0",
#         "prob_death": "1943",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "FSM",
#         "tot_cases": "1",
#         "conf_cases": "1.0",
#         "prob_cases": "0",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "0",
#         "conf_death": "0.0",
#         "prob_death": "0",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "ND",
#         "tot_cases": "99277",
#         "conf_cases": "94232.0",
#         "prob_cases": "5045",
#         "new_case": "49.0",
#         "pnew_case": "6",
#         "tot_death": "1438",
#         "new_death": "1.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "ME",
#         "tot_cases": "43497",
#         "conf_cases": "34501.0",
#         "prob_cases": "8996",
#         "new_case": "131.0",
#         "pnew_case": "59",
#         "tot_death": "658",
#         "conf_death": "643.0",
#         "prob_death": "15",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MO",
#         "tot_cases": "474997",
#         "new_case": "410.0",
#         "pnew_case": "0",
#         "tot_death": "7715",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "VA",
#         "tot_cases": "564115",
#         "conf_cases": "445808.0",
#         "prob_cases": "118307",
#         "new_case": "2303.0",
#         "pnew_case": "645",
#         "tot_death": "7331",
#         "conf_death": "6320.0",
#         "prob_death": "1011",
#         "new_death": "134.0",
#         "pnew_death": "12",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NE",
#         "tot_cases": "198751",
#         "new_case": "309.0",
#         "pnew_case": "0",
#         "tot_death": "2047",
#         "new_death": "4.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "RI",
#         "tot_cases": "123145",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "2376",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "N/A"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "DC",
#         "tot_cases": "39553",
#         "new_case": "92.0",
#         "pnew_case": "0",
#         "tot_death": "994",
#         "new_death": "1.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "IL",
#         "tot_cases": "1172824",
#         "conf_cases": "1172824.0",
#         "prob_cases": "0",
#         "new_case": "1922.0",
#         "pnew_case": "0",
#         "tot_death": "22426",
#         "conf_death": "20234.0",
#         "prob_death": "2192",
#         "new_death": "58.0",
#         "pnew_death": "16",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "VT",
#         "tot_cases": "14359",
#         "new_case": "108.0",
#         "pnew_case": "2",
#         "tot_death": "196",
#         "new_death": "3.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MD",
#         "tot_cases": "376355",
#         "new_case": "618.0",
#         "pnew_case": "0",
#         "tot_death": "7715",
#         "conf_death": "7533.0",
#         "prob_death": "182",
#         "new_death": "18.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "N/A",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "WY",
#         "tot_cases": "53683",
#         "conf_cases": "45583.0",
#         "prob_cases": "8100",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "662",
#         "conf_death": "662.0",
#         "prob_death": "0",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NH",
#         "tot_cases": "73161",
#         "new_case": "394.0",
#         "pnew_case": "131",
#         "tot_death": "1153",
#         "new_death": "1.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "ID",
#         "tot_cases": "169150",
#         "conf_cases": "137430.0",
#         "prob_cases": "31720",
#         "new_case": "197.0",
#         "pnew_case": "46",
#         "tot_death": "1826",
#         "conf_death": "1607.0",
#         "prob_death": "219",
#         "new_death": "-1.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "WA",
#         "tot_cases": "333794",
#         "new_case": "890.0",
#         "pnew_case": "123",
#         "tot_death": "4822",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "N/A",
#         "consent_deaths": "N/A"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NC",
#         "tot_cases": "840096",
#         "conf_cases": "735879.0",
#         "prob_cases": "104217",
#         "new_case": "3446.0",
#         "pnew_case": "1531",
#         "tot_death": "10896",
#         "conf_death": "9655.0",
#         "prob_death": "1241",
#         "new_death": "76.0",
#         "pnew_death": "16",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "AL",
#         "tot_cases": "485986",
#         "conf_cases": "381166.0",
#         "prob_cases": "104820",
#         "new_case": "774.0",
#         "pnew_case": "202",
#         "tot_death": "9590",
#         "conf_death": "7525.0",
#         "prob_death": "2065",
#         "new_death": "17.0",
#         "pnew_death": "6",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "OR",
#         "tot_cases": "152711",
#         "conf_cases": "150991.0",
#         "prob_cases": "1720",
#         "new_case": "521.0",
#         "pnew_case": "0",
#         "tot_death": "2154",
#         "conf_death": "2139.0",
#         "prob_death": "15",
#         "new_death": "5.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "GU",
#         "tot_cases": "7715",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "130",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NJ",
#         "tot_cases": "764374",
#         "conf_cases": "680937.0",
#         "prob_cases": "83437",
#         "new_case": "2876.0",
#         "pnew_case": "245",
#         "tot_death": "22834",
#         "conf_death": "20545.0",
#         "prob_death": "2289",
#         "new_death": "50.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "DE",
#         "tot_cases": "84531",
#         "conf_cases": "80117.0",
#         "prob_cases": "4414",
#         "new_case": "350.0",
#         "pnew_case": "30",
#         "tot_death": "1366",
#         "conf_death": "1235.0",
#         "prob_death": "131",
#         "new_death": "23.0",
#         "pnew_death": "1",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MN",
#         "tot_cases": "478157",
#         "new_case": "870.0",
#         "pnew_case": "161",
#         "tot_death": "6491",
#         "conf_death": "6153.0",
#         "prob_death": "338",
#         "new_death": "11.0",
#         "pnew_death": "1",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "N/A",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "VI",
#         "tot_cases": "2579",
#         "new_case": "4.0",
#         "pnew_case": "0",
#         "tot_death": "25",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MI",
#         "tot_cases": "636269",
#         "conf_cases": "579919.0",
#         "prob_cases": "56350",
#         "new_case": "823.0",
#         "pnew_case": "188",
#         "tot_death": "16342",
#         "conf_death": "15359.0",
#         "prob_death": "983",
#         "new_death": "68.0",
#         "pnew_death": "5",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "SC",
#         "tot_cases": "503908",
#         "conf_cases": "435044.0",
#         "prob_cases": "68864",
#         "new_case": "2223.0",
#         "pnew_case": "575",
#         "tot_death": "8379",
#         "new_death": "16.0",
#         "pnew_death": "4",
#         "created_at": "2021-02-26T15:36:37.777",
#         "consent_cases": "Agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NV",
#         "tot_cases": "290671",
#         "new_case": "371.0",
#         "pnew_case": "0",
#         "tot_death": "4868",
#         "new_death": "37.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "LA",
#         "tot_cases": "422287",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "9440",
#         "conf_death": "8778.0",
#         "prob_death": "662",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "CT",
#         "tot_cases": "273101",
#         "conf_cases": "256139.0",
#         "prob_cases": "16962",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "7523",
#         "conf_death": "6166.0",
#         "prob_death": "1357",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MT",
#         "tot_cases": "98641",
#         "conf_cases": "98641.0",
#         "prob_cases": "0",
#         "new_case": "264.0",
#         "pnew_case": "0",
#         "tot_death": "1341",
#         "conf_death": "1341.0",
#         "prob_death": "0",
#         "new_death": "2.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "WI",
#         "tot_cases": "611789",
#         "conf_cases": "559172.0",
#         "prob_cases": "52617",
#         "new_case": "815.0",
#         "pnew_case": "139",
#         "tot_death": "6871",
#         "conf_death": "6284.0",
#         "prob_death": "587",
#         "new_death": "19.0",
#         "pnew_death": "2",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "PA",
#         "tot_cases": "911591",
#         "conf_cases": "786131.0",
#         "prob_cases": "125460",
#         "new_case": "2818.0",
#         "pnew_case": "593",
#         "tot_death": "23570",
#         "new_death": "90.0",
#         "pnew_death": "72",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "FL",
#         "tot_cases": "1829773",
#         "new_case": "7129.0",
#         "pnew_case": "2382",
#         "tot_death": "29813",
#         "new_death": "121.0",
#         "pnew_death": "8",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NY",
#         "tot_cases": "891374",
#         "new_case": "3542.0",
#         "pnew_case": "0",
#         "tot_death": "17674",
#         "new_death": "52.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "PW",
#         "tot_cases": "0",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "0",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "AK",
#         "tot_cases": "55198",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "286",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "N/A",
#         "consent_deaths": "N/A"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "NM",
#         "tot_cases": "182475",
#         "new_case": "425.0",
#         "pnew_case": "0",
#         "tot_death": "3610",
#         "new_death": "11.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "N/A",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "MP",
#         "tot_cases": "143",
#         "conf_cases": "143.0",
#         "prob_cases": "0",
#         "new_case": "8.0",
#         "pnew_case": "0",
#         "tot_death": "2",
#         "conf_death": "2.0",
#         "prob_death": "0",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "OH",
#         "tot_cases": "952306",
#         "conf_cases": "818994.0",
#         "prob_cases": "133312",
#         "new_case": "2611.0",
#         "pnew_case": "1110",
#         "tot_death": "16749",
#         "conf_death": "14248.0",
#         "prob_death": "2501",
#         "new_death": "56.0",
#         "pnew_death": "12",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "TN",
#         "tot_cases": "764008",
#         "conf_cases": "641998.0",
#         "prob_cases": "122010",
#         "new_case": "1335.0",
#         "pnew_case": "452",
#         "tot_death": "11115",
#         "conf_death": "8942.0",
#         "prob_death": "2173",
#         "new_death": "51.0",
#         "pnew_death": "7",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "TX",
#         "tot_cases": "2583617",
#         "new_case": "6486.0",
#         "pnew_case": "1454",
#         "tot_death": "41213",
#         "new_death": "227.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "IA",
#         "tot_cases": "332228",
#         "new_case": "460.0",
#         "pnew_case": "115",
#         "tot_death": "5336",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "KS",
#         "tot_cases": "290832",
#         "conf_cases": "236146.0",
#         "prob_cases": "54686",
#         "new_case": "0.0",
#         "pnew_case": "0",
#         "tot_death": "4614",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "N/A"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "WV",
#         "tot_cases": "129364",
#         "conf_cases": "103525.0",
#         "prob_cases": "25839",
#         "new_case": "309.0",
#         "pnew_case": "46",
#         "tot_death": "2254",
#         "new_death": "6.0",
#         "pnew_death": "2",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "HI",
#         "tot_cases": "26293",
#         "new_case": "49.0",
#         "pnew_case": "0",
#         "tot_death": "427",
#         "new_death": "0.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Not agree",
#         "consent_deaths": "Not agree"
#     },
#     {
#         "submission_date": "2021-02-20T00:00:00.000",
#         "state": "PR",
#         "tot_cases": "99064",
#         "conf_cases": "91527.0",
#         "prob_cases": "7537",
#         "new_case": "229.0",
#         "pnew_case": "26",
#         "tot_death": "1979",
#         "conf_death": "1686.0",
#         "prob_death": "293",
#         "new_death": "22.0",
#         "pnew_death": "0",
#         "created_at": "2021-02-21T14:57:50.842",
#         "consent_cases": "Agree",
#         "consent_deaths": "Agree"
#     }
# ]


    